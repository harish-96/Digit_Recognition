<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Neural_Network package &#8212; Digit_Recognition 1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="Digit_Recognition 1 documentation" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="neural-network-package">
<h1>Neural_Network package<a class="headerlink" href="#neural-network-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-Neural_Network.neuralnet">
<span id="neural-network-neuralnet-module"></span><h2>Neural_Network.neuralnet module<a class="headerlink" href="#module-Neural_Network.neuralnet" title="Permalink to this headline">¶</a></h2>
<div class="section" id="neural-network">
<h3>Neural Network<a class="headerlink" href="#neural-network" title="Permalink to this headline">¶</a></h3>
<p>A module to train a neural network with an arbitrary number of layers and
and arbitrary number of neurons per layer. Use as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neuralnet</span> <span class="k">import</span> <span class="n">NN_hwr</span>
<span class="n">nn</span> <span class="o">=</span> <span class="n">NN_hwr</span><span class="p">([</span><span class="nb">list</span> <span class="n">containing</span> <span class="n">number</span> <span class="n">of</span> <span class="n">neurons</span> <span class="n">per</span> <span class="n">layer</span><span class="p">])</span>
<span class="n">nn</span><span class="o">.</span><span class="n">train_nn</span><span class="p">(</span><span class="n">Input</span> <span class="n">training</span> <span class="n">data</span><span class="p">,</span> <span class="n">label_data</span><span class="p">,</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">iterations</span><span class="p">,</span>
            <span class="n">Number</span> <span class="n">of</span> <span class="n">examples</span> <span class="n">per</span> <span class="n">batch</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">)</span>
</pre></div>
</div>
<dl class="class">
<dt id="Neural_Network.neuralnet.NN_hwr">
<em class="property">class </em><code class="descclassname">Neural_Network.neuralnet.</code><code class="descname">NN_hwr</code><span class="sig-paren">(</span><em>num_neurons_list</em><span class="sig-paren">)</span><a class="headerlink" href="#Neural_Network.neuralnet.NN_hwr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>A template class for a generic neural network.
Initialise with a list with each element being the number of neurons in
that layer
For the init function, the parameters are</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>num_neurons_list</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#list" title="(in Python v2.7)"><em>list</em></a>) &#8211; Create a neural network number
of neuron per layer given by the list</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="Neural_Network.neuralnet.NN_hwr.accuracy">
<code class="descname">accuracy</code><span class="sig-paren">(</span><em>X_test</em>, <em>y_test</em><span class="sig-paren">)</span><a class="headerlink" href="#Neural_Network.neuralnet.NN_hwr.accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the accuracy with which the Network, once trained classifies
the digits.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X_test</strong> (<em>ndarray</em>) &#8211; Test data in the same format as that for which
the network was trained</li>
<li><strong>y_test</strong> (<em>ndarray</em>) &#8211; Labels for the test data. Same format as the
labels for training data</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Float value of the accuracy in percentage</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Neural_Network.neuralnet.NN_hwr.back_prop">
<code class="descname">back_prop</code><span class="sig-paren">(</span><em>training_example</em><span class="sig-paren">)</span><a class="headerlink" href="#Neural_Network.neuralnet.NN_hwr.back_prop" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the partial derivatives of the cost function with respect to
the weights and biases of the network
training_example is a tuple with element fisrt element an np array and
the second, an array of length 10 of zeros everywhere except at the
image label where there is a 1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>training_example</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) &#8211; Tuple with first element as the input
data and the second being its label</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a tuple of numpy arrays containing the required derivatives</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Neural_Network.neuralnet.NN_hwr.cost_derivative">
<code class="descname">cost_derivative</code><span class="sig-paren">(</span><em>activation</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#Neural_Network.neuralnet.NN_hwr.cost_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the derivative of the cost function given output activations and
the labels</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>activation</strong> (<em>ndarray</em>) &#8211; Activations of the neurons for a given input</li>
<li><strong>y</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#list" title="(in Python v2.7)"><em>list</em></a>) &#8211; The expected output for the input</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Float value of the cost function of the Neural Network</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Neural_Network.neuralnet.NN_hwr.cost_function">
<code class="descname">cost_function</code><span class="sig-paren">(</span><em>X_train</em>, <em>y_train</em><span class="sig-paren">)</span><a class="headerlink" href="#Neural_Network.neuralnet.NN_hwr.cost_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the quadratic cost function of the Neural Network</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X_train</strong> (<em>ndarray</em>) &#8211; Input data for training</li>
<li><strong>y_train</strong> (<em>ndarray</em>) &#8211; Labels corresponding to the inputs</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Float value of the cost function of the Neural Network</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Neural_Network.neuralnet.NN_hwr.forward_prop">
<code class="descname">forward_prop</code><span class="sig-paren">(</span><em>x_train</em><span class="sig-paren">)</span><a class="headerlink" href="#Neural_Network.neuralnet.NN_hwr.forward_prop" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the activations and weighted inputs of the neurons in
the network for the given input data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x_train</strong> (<em>ndarray</em>) &#8211; The input for the first layer which needs
to be forwards propogated</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A tuple of lists containing activations and weighted inputs</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Neural_Network.neuralnet.NN_hwr.train_batch">
<code class="descname">train_batch</code><span class="sig-paren">(</span><em>batch</em>, <em>learning_rate</em><span class="sig-paren">)</span><a class="headerlink" href="#Neural_Network.neuralnet.NN_hwr.train_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the network with one subset of the training data.
Input is the subset of training data for witch the network is
to be trained. Learning rate governs the rate at which the
Weights and biases change in the gradient descent algorithm</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>batch</strong> (<em>ndarray</em>) &#8211; An array of training examples with each
being a tuple containing the input data and its label.</li>
<li><strong>learning_rate</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The learning rate which determines
the step size in gradient descent</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Neural_Network.neuralnet.NN_hwr.train_nn">
<code class="descname">train_nn</code><span class="sig-paren">(</span><em>X_train</em>, <em>y_train</em>, <em>n_epochs</em>, <em>batch_size</em>, <em>learning_rate</em><span class="sig-paren">)</span><a class="headerlink" href="#Neural_Network.neuralnet.NN_hwr.train_nn" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the neural network with the test data. n_epochs is the number
sweeps over the whole data. batch_size is the number of training
example per batch in the stochastic gradient descent. X_train and
y_train are the images and labels in the training data. X_train must
be a 2-D array with only one row and y_train is an array of length 10
of zeros everywhere except at the image label (where there is a 1)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X_train</strong> (<em>ndarray</em>) &#8211; Numpy array containing the input training data</li>
<li><strong>y_train</strong> (<em>ndarray</em>) &#8211; Numpy array containing the labels for training.
Formatted as an array of arrays with 1 at the label position and 0
everywhere else</li>
<li><strong>n_epochs</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The number of sweeps over the data-set in the
Stochastic Gradient Descent</li>
<li><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Number of training examples per batch in the
Stochastic Gradient Descent</li>
<li><strong>learning_rate</strong> (<em>fload</em>) &#8211; The learning rate which determines the
step size in gradient descent</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="Neural_Network.neuralnet.sigmoid">
<code class="descclassname">Neural_Network.neuralnet.</code><code class="descname">sigmoid</code><span class="sig-paren">(</span><em>z</em><span class="sig-paren">)</span><a class="headerlink" href="#Neural_Network.neuralnet.sigmoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the sigmoid function at the given input</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>z</strong> (<em>array-like</em>) &#8211; Could be a number, list or Numpy array for
which sigmoid is to be evaluated</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">numpy array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Neural_Network.neuralnet.sigmoid_derivative">
<code class="descclassname">Neural_Network.neuralnet.</code><code class="descname">sigmoid_derivative</code><span class="sig-paren">(</span><em>z</em><span class="sig-paren">)</span><a class="headerlink" href="#Neural_Network.neuralnet.sigmoid_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the derivative of the sigmoid function at the given input</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>z</strong> (<em>array-like</em>) &#8211; Could be a number, list or Numpy array for which
sigmoid derivative is to be evaluated</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Numpy array</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="module-Neural_Network.train_network">
<span id="neural-network-train-network-module"></span><h2>Neural_Network.train_network module<a class="headerlink" href="#module-Neural_Network.train_network" title="Permalink to this headline">¶</a></h2>
<div class="section" id="useful-functionality-for-training-neural-network">
<h3>Useful functionality for training Neural Network<a class="headerlink" href="#useful-functionality-for-training-neural-network" title="Permalink to this headline">¶</a></h3>
<p>Functions to unpack the data from the MNIST database, uncompress the data and display it</p>
<dl class="function">
<dt id="Neural_Network.train_network.display_data">
<code class="descclassname">Neural_Network.train_network.</code><code class="descname">display_data</code><span class="sig-paren">(</span><em>imgs</em>, <em>nrows=1</em>, <em>ncols=1</em>, <em>nx_pixels=28</em>, <em>ny_pixels=28</em><span class="sig-paren">)</span><a class="headerlink" href="#Neural_Network.train_network.display_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Dispay the images given in X.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nrows</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The number of plots per column. The default value is 1</li>
<li><strong>ncols</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The number of plots per row. The default value is 1</li>
<li><strong>nx_pixels</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The number of pixels along axis 1.
The default value is 28</li>
<li><strong>ny_pixels</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The number of pixels along axis 2. The default
value is 28</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None.Displays the Image Data</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Neural_Network.train_network.load_data">
<code class="descclassname">Neural_Network.train_network.</code><code class="descname">load_data</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#Neural_Network.train_network.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the image data from the path provided and returns the images and
labels</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; The path to the file where the training/test data is
present</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A dictionary object containing the input data and labels
Keys of the dict object &#8211; &#8216;X_train&#8217; and &#8216;y_train&#8217; or &#8216;X_test&#8217;
and &#8216;y_test&#8217;</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Neural_Network.train_network.unpack_dat">
<code class="descclassname">Neural_Network.train_network.</code><code class="descname">unpack_dat</code><span class="sig-paren">(</span><em>imgpath</em>, <em>labpath</em><span class="sig-paren">)</span><a class="headerlink" href="#Neural_Network.train_network.unpack_dat" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpack images and labels obtained online from
<a class="reference external" href="http://yann.lecun.com/exdb/mnist/">MNIST Database</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>imgpath</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; The path for the packed image file of MNIST Database</li>
<li><strong>labpath</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; The path for the packed label file of MNIST Database</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Tuple of list of image pixel values and label values.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="module-Neural_Network">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-Neural_Network" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Neural_Network package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-Neural_Network.neuralnet">Neural_Network.neuralnet module</a><ul>
<li><a class="reference internal" href="#neural-network">Neural Network</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-Neural_Network.train_network">Neural_Network.train_network module</a><ul>
<li><a class="reference internal" href="#useful-functionality-for-training-neural-network">Useful functionality for training Neural Network</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-Neural_Network">Module contents</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Neural_Network.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Harish Murali and Surya Mohan.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.8</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="_sources/Neural_Network.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>